<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ä¸“æ³¨æ¨¡å¼é¡µé¢</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
<link rel="stylesheet" href="common-style.css">
<script src="bridge.js"></script>
<style>
/* ä¸“æ³¨æ¨¡å¼ç‰¹å®šæ ·å¼ */
.top-section {
    flex: 1;
    display: flex;
    padding: 25px;
    gap: 25px;
}

.bottom-section {
    height: 100px;
    padding: 0 25px 25px 25px;
    display: flex;
    flex-direction: column;
    justify-content: center;
    flex-shrink: 0;
}

.timer-panel {
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    width: 80%;
    height: 100%;
    font-size: calc(0.5vw + 0.5vh + 10px);
}

.timer-icon {
    font-size: 4em;
    color: #3498DB;
    margin-bottom: 0.5em;
    animation: pulse 2s infinite ease-in-out;
}

.time-display {
    font-size: 150px;
    font-weight: 900;
    color: #FFFFFF;
    letter-spacing: 5px;
    line-height: 1;
    font-variant-numeric: tabular-nums; /* ç­‰å®½æ•°å­— */
    font-family: 'Consolas', 'Courier New', monospace; /* ç­‰å®½å­—ä½“ */
}

/* è®¡æ—¶å™¨æŒ‰é’®ç»„ */
.timer-controls {
    margin-top: 30px; /* ä¸Šæ–¹é—´è· */
    display: flex;    
    gap: 15px;        /* æŒ‰é’®é—´è· */
}

/* æ§åˆ¶æŒ‰é’®åŸºç¡€æ ·å¼ */
.control-button {
    padding: 12px 25px;
    border: none;
    border-radius: 6px;
    font-size: 18px;
    font-weight: 600;
    cursor: pointer;
    transition: background-color 0.2s, transform 0.1s; /* äº¤äº’åŠ¨ç”» */
    color: white;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
}
.control-button:active {
    transform: scale(0.95); /* æŒ‰ä¸‹ç¼©æ”¾æ•ˆæœ */
}
#startButton {
    background-color: #27AE60; /* é»˜è®¤ç»¿è‰² */
}
#startButton.running {
    background-color: #C0392B; /* è¿è¡Œä¸­çº¢è‰² */
}
#stopButton {
    background-color: #E74C3C; /* çº¢è‰²åœæ­¢æŒ‰é’® */
}
#resetButton {
    background-color: #7F8C8D; /* ç°è‰²é‡ç½®æŒ‰é’® */
}

/* è®¡æ—¶çŠ¶æ€æ–‡æœ¬ */
.status-text {
    font-size: 20px;
    color: #ECF0F1;
    margin-top: 15px;
}

/* ============================
   å³ä¾§: è®¾ç½®åŒºåŸŸ settings-panel
   ============================ */
.settings-panel {
    text-align: left; /* å·¦å¯¹é½ */
    overflow-y: auto; /* è¶…å‡ºå†…å®¹å¯æ»šåŠ¨ */
}

.settings-title {
    font-size: 28px;
    font-weight: 700;
    color: #FFFFFF;
    margin-bottom: 30px;
    text-align: center;
    border-bottom: 2px solid rgba(255, 255, 255, 0.2);
    padding-bottom: 15px;
}

.setting-group {
    margin-bottom: 25px; /* å„è®¾ç½®é¡¹é—´è· */
}

label {
    display: block;
    font-size: 16px;
    font-weight: 600;
    margin-bottom: 8px;
    color: #ECF0F1;
}

select, input[type="number"], input[type="text"] {
    width: 100%;   /* å æ»¡çˆ¶å®¹å™¨å®½åº¦ */
    padding: 12px;
    border: 1px solid #444;
    border-radius: 6px;
    box-sizing: border-box;
    font-size: 16px;
    background-color: rgba(0, 0, 0, 0.4);
    color: #FFFFFF;
    -webkit-appearance: none;
    -moz-appearance: none;
    appearance: none;
}
select option {
    background-color: #333333;
    color: #FFFFFF;
}

/* è‡ªå®šä¹‰ä¼‘æ¯æ—¶é•¿è¾“å…¥æ¡†ï¼Œåˆå§‹éšè— */
#break-duration-group {
    display: none;
}

/* ============================
   åº•éƒ¨è¿›åº¦æ¡
   ============================ */
.progress-title {
    font-size: 16px;
    color: #ECF0F1;
    margin-bottom: 8px;
    font-weight: 600;
}

.progress-bar-container {
    width: 100%;
    height: 18px;
    background-color: rgba(255, 255, 255, 0.2); /* åº•è‰² */
    border-radius: 9px; /* åœ†è§’ */
    position: relative; /* ä¸ºå†…éƒ¨ marker å®šä½ */
}

.progress-fill {
    height: 100%;
    width: 0%; /* åˆå§‹å®½åº¦ */
    background-color: #3498DB;
    border-radius: 9px;
    transition: width 0.5s ease-out; /* å¹³æ»‘åŠ¨ç”» */
}

.task-markers {
    position: absolute; /* marker ç»å¯¹å®šä½åœ¨è¿›åº¦æ¡ä¸Š */
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
}

.marker {
    position: absolute;
    height: 150%;  /* é«˜åº¦ç¨å¾®è¶…å‡ºè¿›åº¦æ¡ */
    width: 4px;
    background-color: #E74C3C;
    transform: translateY(-25%); /* å‚ç›´å±…ä¸­ */
    border-radius: 2px;
    z-index: 10; /* ç¡®ä¿è¦†ç›–åœ¨è¿›åº¦æ¡ä¸Šæ–¹ */
}
</style>



</head>
<body>

<div class="focus-container">
 
<div class="top-section">
 
<div class="panel timer-panel">
<i class="fas fa-hourglass-half timer-icon" id="timerIcon"></i>
<div id="currentTime" class="time-display">25:00</div>
<div id="timerStatus" class="status-text">ä¸“æ³¨è®¡æ—¶å·²åœæ­¢</div>

<div class="timer-controls">
<button class="control-button" id="startButton">
<i class="fas fa-play"></i> å¼€å§‹ä¸“æ³¨
</button>
<button class="control-button" id="stopButton">
<i class="fas fa-stop"></i> åœæ­¢ä¸“æ³¨
</button>
<button class="control-button" id="resetButton">
<i class="fas fa-redo"></i> é‡ç½®è®¡æ—¶å™¨
</button>
</div>
</div>

<div class="panel settings-panel">
<div class="settings-title">ä¸“æ³¨æ¨¡å¼</div>
 
<div class="setting-group">
<label for="mode-select">é€‰æ‹©æ¨¡å¼</label>
<select id="mode-select">
<option value="pomodoro">ç•ªèŒ„å·¥ä½œæ³• (25/5)</option>
<option value="deep-work">æ·±åº¦å·¥ä½œ (90/15)</option>
<option value="break">ä¼‘æ¯æ¨¡å¼ (10åˆ†é’Ÿ)</option>
<option value="custom">è‡ªå®šä¹‰æ¨¡å¼</option>
</select>
</div>

<div class="setting-group">
<label for="task-input">å½“å‰ä¸“æ³¨ä»»åŠ¡</label>
<input type="text" id="task-input" value="ç¼–å†™æ–°çš„å‰ç«¯å¸ƒå±€ä»£ç ">
</div>

<div class="setting-group">
<label for="duration-input">ä¸“æ³¨æ—¶é•¿ (åˆ†é’Ÿ)</label>
<input type="number" id="duration-input" value="25" min="1" max="180">
</div>
 
<div class="setting-group" id="break-duration-group">
<label for="break-duration-input">ä¼‘æ¯æ—¶é•¿ (åˆ†é’Ÿ)</label>
<input type="number" id="break-duration-input" value="5" min="1" max="60">
</div>
</div>
 
</div>

<div class="bottom-section">
<div class="progress-title" id="progressTitle">ä»»åŠ¡æ—¶é—´è½´ (å½“å‰ä¸“æ³¨: 25åˆ†é’Ÿ)</div>
 
<div class="progress-bar-container">
<div class="progress-fill" id="progressBarFill"></div>
 
<div class="task-markers" id="taskMarkers">
<div class="marker" style="left: 20%; background-color: #F1C40F;" title="åˆ†å¿ƒ/èŠå¤©"></div>
<div class="marker" style="left: 75%; background-color: #9B59B6;" title="å°ä¼‘æ¯"></div>
</div>
</div>
</div>

</div>

<script>
// å…¨å±€å˜é‡ - ä¸“æ³¨ä¼šè¯æ•°æ®
let focusSession = {
    taskName: '',
    startTime: null,
    endTime: null,
    focusDuration: 0,  // åˆ†é’Ÿ
    breakDuration: 0,  // åˆ†é’Ÿ
    isCompleted: false
};

// APIè°ƒç”¨å‡½æ•°
/**
 * ä¿å­˜ä¸“æ³¨ä¼šè¯è®°å½•åˆ°Bridge
 */
async function saveFocusSession(taskName, duration, breakDuration, startTime, endTime, completed) {
    try {
        const sessionData = {
            taskName: taskName,
            startTime: startTime,    // ISOæ ¼å¼æ—¶é—´å­—ç¬¦ä¸²
            endTime: endTime,        // ISOæ ¼å¼æ—¶é—´å­—ç¬¦ä¸²
            focusDuration: duration, // åˆ†é’Ÿ
            breakDuration: breakDuration, // åˆ†é’Ÿ
            isCompleted: completed
        };
        
        console.log("ä¿å­˜ä¸“æ³¨ä¼šè¯è®°å½•", sessionData);
        
        // ä½¿ç”¨Bridgeå‘é€å®Œæ•´çš„ä¼šè¯æ•°æ®
        try {
            await Bridge.send('saveFocusSession', sessionData);
            console.log("ä¸“æ³¨ä¼šè¯è®°å½•ä¿å­˜æˆåŠŸ");
            return { success: true };
        } catch (bridgeError) {
            console.warn("Bridgeè°ƒç”¨å¤±è´¥ï¼Œä»…è®°å½•åˆ°æ§åˆ¶å°:", bridgeError.message);
            // è°ƒç”¨å¤±è´¥æ—¶ç»§ç»­æ‰§è¡Œï¼Œä¸å½±å“ç”¨æˆ·ä½“éªŒ
        }
        
        return { success: true };
    } catch (error) {
        console.error("ä¿å­˜ä¸“æ³¨ä¼šè¯è®°å½•å¤±è´¥:", error);
        return { success: false, error: error.message };
    }
}

/**
 * åŠ è½½ä¸“æ³¨è®¾ç½®
 */
async function loadFocusSettings() {
    try {
        console.log("åŠ è½½ä¸“æ³¨è®¾ç½®");
        
        // é»˜è®¤è®¾ç½®
        let settings = {
            mode: 'pomodoro',
            duration: 25,
            breakDuration: 5,
            lastTask: "ç¼–å†™æ–°çš„å‰ç«¯å¸ƒå±€ä»£ç "
        };
        
        // å°è¯•é€šè¿‡BridgeåŠ è½½è®¾ç½®
        try {
            const response = await Bridge.send('loadFocusSettings', null, true);
            if (response) {
                settings = {
                    mode: response.mode || 'pomodoro',
                    duration: response.duration || 25,
                    breakDuration: response.breakDuration || 5,
                    lastTask: response.lastTask || "ç¼–å†™æ–°çš„å‰ç«¯å¸ƒå±€ä»£ç "
                };
                console.log("æˆåŠŸä»BridgeåŠ è½½ä¸“æ³¨è®¾ç½®");
            } else {
                console.log("Bridgeè¿”å›è®¾ç½®ä¸ºç©ºï¼Œä½¿ç”¨é»˜è®¤è®¾ç½®");
            }
        } catch (error) {
            console.warn("Bridgeè°ƒç”¨å¤±è´¥ï¼Œä½¿ç”¨é»˜è®¤è®¾ç½®:", error.message);
        }
        
        // åº”ç”¨è®¾ç½®
        if (settings.mode) {
            document.getElementById('mode-select').value = settings.mode;
            document.getElementById('mode-select').dispatchEvent(new Event('change'));
        }
        if (settings.duration) {
            document.getElementById('duration-input').value = settings.duration;
        }
        if (settings.breakDuration) {
            document.getElementById('break-duration-input').value = settings.breakDuration;
        }
        if (settings.lastTask) {
            document.getElementById('task-input').value = settings.lastTask;
        }
        
        console.log("ä¸“æ³¨è®¾ç½®åŠ è½½æˆåŠŸ");
        return settings;
    } catch (error) {
        console.error("åŠ è½½ä¸“æ³¨è®¾ç½®å¤±è´¥:", error);
        return null;
    }
}

/**
 * ä¿å­˜ä¸“æ³¨è®¾ç½®
 */
async function saveFocusSettings(settings) {
    try {
        console.log("ä¿å­˜ä¸“æ³¨è®¾ç½®", settings);
        
        // ä½¿ç”¨Bridgeä¿å­˜è®¾ç½®
        try {
            await Bridge.send('saveFocusSettings', settings);
            console.log("ä¸“æ³¨è®¾ç½®ä¿å­˜æˆåŠŸ");
            return { success: true };
        } catch (error) {
            console.warn("Bridgeè°ƒç”¨å¤±è´¥ï¼Œè®¾ç½®æœªä¿å­˜åˆ°æœåŠ¡å™¨:", error.message);
            // è°ƒç”¨å¤±è´¥æ—¶ç»§ç»­æ‰§è¡Œï¼Œä¸å½±å“ç”¨æˆ·ä½“éªŒ
        }
        
        return { success: true };
    } catch (error) {
        console.error("ä¿å­˜ä¸“æ³¨è®¾ç½®å¤±è´¥:", error);
        return { success: false, error: error.message };
    }
}

document.addEventListener('DOMContentLoaded', async () => {
// åŠ è½½ä¸“æ³¨è®¾ç½®
await loadFocusSettings();

// å˜é‡å£°æ˜
const timeDisplay = document.getElementById('currentTime');
const statusText = document.getElementById('timerStatus');
const progressBarFill = document.getElementById('progressBarFill');
const startButton = document.getElementById('startButton');
const stopButton = document.getElementById('stopButton');
const resetButton = document.getElementById('resetButton');
const modeSelect = document.getElementById('mode-select');
const durationInput = document.getElementById('duration-input');
const breakDurationGroup = document.getElementById('break-duration-group');
const breakDurationInput = document.getElementById('break-duration-input');
const progressTitle = document.getElementById('progressTitle');
const timerIcon = document.getElementById('timerIcon');
const taskInput = document.getElementById('task-input');

let isRunning = false;
let isPaused = false;
let totalDuration = 25 * 60; // é»˜è®¤ 25 åˆ†é’Ÿï¼Œä»¥ç§’ä¸ºå•ä½
let remainingTime = totalDuration;
let timerInterval;

// --- æ¨¡å¼åˆ‡æ¢é€»è¾‘ ---
const modes = {
'pomodoro': { focus: 25, break: 5, status: "ç•ªèŒ„å·¥ä½œæ³•" },
'deep-work': { focus: 90, break: 15, status: "æ·±åº¦å·¥ä½œæ¨¡å¼" },
'break': { focus: 10, break: 0, status: "ä¼‘æ¯æ—¶é—´" },
'custom': { focus: 25, break: 5, status: "è‡ªå®šä¹‰æ¨¡å¼" }
};

modeSelect.addEventListener('change', () => {
const selectedMode = modeSelect.value;
const mode = modes[selectedMode];

if (selectedMode === 'custom') {
// è‡ªå®šä¹‰æ¨¡å¼ï¼šæ˜¾ç¤ºä¼‘æ¯æ—¶é•¿è¾“å…¥æ¡†
breakDurationGroup.style.display = 'block';
durationInput.readOnly = false;
breakDurationInput.readOnly = false;
} else {
// é¢„è®¾æ¨¡å¼ï¼šéšè—ä¼‘æ¯æ—¶é•¿ï¼Œè®¾ç½®é¢„è®¾å€¼
breakDurationGroup.style.display = 'none';
durationInput.value = mode.focus;
breakDurationInput.value = mode.break;
durationInput.readOnly = true;
breakDurationInput.readOnly = true;
}

if (!isRunning && !isPaused) {
// å¦‚æœè®¡æ—¶å™¨æœªå¯åŠ¨ï¼Œåˆ™æ›´æ–°æ˜¾ç¤º
totalDuration = parseInt(durationInput.value) * 60;
remainingTime = totalDuration;
updateDisplay();
}
});

// å½“è‡ªå®šä¹‰æ—¶é•¿å˜åŒ–æ—¶ï¼Œæ›´æ–°æ€»æ—¶é•¿
durationInput.addEventListener('input', () => {
if (!isRunning && !isPaused) {
totalDuration = parseInt(durationInput.value) * 60;
remainingTime = totalDuration;
updateDisplay();
}
});

// --- è®¡æ—¶å™¨æ§åˆ¶å‡½æ•° ---

/**
* ä¿®æ­£: å§‹ç»ˆæ ¼å¼åŒ–ä¸º HH:MM:SS æ ¼å¼ï¼ˆå…±8ä¸ªå­—ç¬¦ï¼‰ï¼Œä»¥ç¡®ä¿å®½åº¦ä¸€è‡´æ€§ã€‚
* ä¾‹å¦‚ï¼š 25:00 -> 00:25:00, 90:00 -> 01:30:00
*/
function formatTime(seconds) {
const h = Math.floor(seconds / 3600);
const m = Math.floor((seconds % 3600) / 60);
const s = seconds % 60;
 
// å§‹ç»ˆè¿”å› HH:MM:SS æ ¼å¼ï¼Œç¡®ä¿æ˜¾ç¤ºå®½åº¦å›ºå®š
return `${h.toString().padStart(2, '0')}:${m.toString().padStart(2, '0')}:${s.toString().padStart(2, '0')}`;
}

function updateDisplay() {
// æ›´æ–°æ—¶é—´æ˜¾ç¤º
timeDisplay.textContent = formatTime(remainingTime);
 
// æ›´æ–°è¿›åº¦æ¡
const progressPercent = ((totalDuration - remainingTime) / totalDuration) * 100;
progressBarFill.style.width = `${Math.min(100, progressPercent).toFixed(2)}%`;
 
// æ›´æ–°æ ‡é¢˜
progressTitle.textContent = `ä»»åŠ¡æ—¶é—´è½´ (å½“å‰ä¸“æ³¨: ${durationInput.value}åˆ†é’Ÿ)`;

if (remainingTime <= 0) {
stopTimer(true); // è®¡æ—¶ç»“æŸï¼Œè‡ªåŠ¨åœæ­¢
}
}

function startTimer() {
// å¦‚æœæ˜¯æš‚åœçŠ¶æ€ï¼Œç»§ç»­
if (isPaused) {
    isPaused = false;
    statusText.textContent = `ğŸš€ æ­£åœ¨ä¸“æ³¨: ${taskInput.value}`;
    startButton.innerHTML = '<i class="fas fa-pause"></i> æš‚åœä¸“æ³¨';
    startButton.classList.add('running');
    timerIcon.style.animationPlayState = 'running';
 
} else if (!isRunning) {
    // å…¨æ–°å¼€å§‹
    const durationValue = parseInt(durationInput.value);
    if (isNaN(durationValue) || durationValue <= 0) {
        console.error("ä¸“æ³¨æ—¶é•¿å¿…é¡»å¤§äº 0 åˆ†é’Ÿã€‚");
        return;
    }
    
    // åˆå§‹åŒ–ä¸“æ³¨ä¼šè¯æ•°æ®
    focusSession = {
        taskName: taskInput.value,
        startTime: new Date().toISOString(),
        endTime: null,
        focusDuration: durationValue,
        breakDuration: parseInt(breakDurationInput.value),
        isCompleted: false
    };
    
    totalDuration = durationValue * 60;
    remainingTime = totalDuration;
    isRunning = true;
    isPaused = false;
 
    statusText.textContent = `ğŸš€ æ­£åœ¨ä¸“æ³¨: ${taskInput.value}`;
    startButton.innerHTML = '<i class="fas fa-pause"></i> æš‚åœä¸“æ³¨';
    startButton.classList.add('running');
    timerIcon.style.animationPlayState = 'running';
 
    // åˆå§‹åŒ–è¿›åº¦æ¡
    progressBarFill.style.width = `0%`;
} else {
    // æ­£åœ¨è¿è¡Œï¼Œç‚¹å‡»æš‚åœ
    isPaused = true;
    statusText.textContent = "â¸ï¸ ä¸“æ³¨å·²æš‚åœ";
    startButton.innerHTML = '<i class="fas fa-play"></i> ç»§ç»­ä¸“æ³¨';
    startButton.classList.remove('running');
    timerIcon.style.animationPlayState = 'paused';
}
 
// è®¾ç½®æˆ–æ¸…é™¤è®¡æ—¶å™¨
if (isRunning && !isPaused) {
timerInterval = setInterval(() => {
remainingTime--;
updateDisplay();
}, 1000);
} else {
clearInterval(timerInterval);
}
}

function stopTimer(finished = false) {
clearInterval(timerInterval);
 
// è®¾ç½®ç»“æŸæ—¶é—´å¹¶ä¿å­˜ä¼šè¯è®°å½•
if (isRunning && focusSession.startTime) {
    focusSession.endTime = new Date().toISOString();
    focusSession.isCompleted = finished;
    
    // ä¿å­˜ä¸“æ³¨ä¼šè¯è®°å½•
    saveFocusSession(
        focusSession.taskName,
        focusSession.focusDuration,
        focusSession.breakDuration,
        focusSession.startTime,
        focusSession.endTime,
        focusSession.isCompleted
    );
}
 
isRunning = false;
isPaused = false;
 
// é‡ç½®æ—¶é—´ä¸ºåˆå§‹è®¾ç½®å€¼
totalDuration = parseInt(durationInput.value) * 60;
remainingTime = totalDuration;

startButton.innerHTML = '<i class="fas fa-play"></i> å¼€å§‹ä¸“æ³¨';
startButton.classList.remove('running');
startButton.style.backgroundColor = '#27AE60'; // é‡ç½®ä¸ºç»¿è‰²
timerIcon.style.animationPlayState = 'paused';

if (finished) {
    statusText.textContent = `âœ… ä¸“æ³¨å®Œæˆï¼ä¼‘æ¯æ—¶é—´: ${breakDurationInput.value}åˆ†é’Ÿ`;
    console.log("ä¸“æ³¨æ—¶é—´åˆ°ï¼");
} else {
    statusText.textContent = "ğŸ›‘ ä¸“æ³¨è®¡æ—¶å·²åœæ­¢";
}

updateDisplay();
}
 
// --- äº‹ä»¶ç»‘å®š ---
startButton.addEventListener('click', startTimer);
stopButton.addEventListener('click', () => stopTimer(false));

// é‡ç½®æŒ‰é’®åŠŸèƒ½ - ä»…é‡ç½®è®¡æ—¶å™¨çŠ¶æ€ï¼Œä¸åœæ­¢ä¼šè¯
resetButton.addEventListener('click', function() {
    // å¦‚æœè®¡æ—¶å™¨æ­£åœ¨è¿è¡Œï¼Œå…ˆåœæ­¢å¹¶ä¿å­˜
    if (isRunning || isPaused) {
        stopTimer(false);
    }
    
    // é‡ç½®UIæ˜¾ç¤º
    startButton.innerHTML = '<i class="fas fa-play"></i> å¼€å§‹ä¸“æ³¨';
    startButton.classList.remove('running');
    startButton.style.backgroundColor = '#27AE60';
    timerIcon.style.animationPlayState = 'paused';
    statusText.textContent = "ä¸“æ³¨è®¡æ—¶å·²åœæ­¢";
    
    // é‡ç½®ä¼šè¯æ•°æ®
    focusSession = {
        taskName: '',
        startTime: null,
        endTime: null,
        focusDuration: 0,
        breakDuration: 0,
        isCompleted: false
    };
    
    console.log("è®¡æ—¶å™¨å·²é‡ç½®");
});

// ç›‘å¬è®¾ç½®å˜åŒ–å¹¶ä¿å­˜
modeSelect.addEventListener('change', function() {
    const settings = {
        mode: this.value,
        duration: parseInt(durationInput.value),
        breakDuration: parseInt(breakDurationInput.value),
        lastTask: document.getElementById('task-input').value
    };
    saveFocusSettings(settings);
});

durationInput.addEventListener('change', function() {
    if (!isRunning && !isPaused) {
        const settings = {
            mode: modeSelect.value,
            duration: parseInt(this.value),
            breakDuration: parseInt(breakDurationInput.value),
            lastTask: document.getElementById('task-input').value
        };
        saveFocusSettings(settings);
    }
});

breakDurationInput.addEventListener('change', function() {
    const settings = {
        mode: modeSelect.value,
        duration: parseInt(durationInput.value),
        breakDuration: parseInt(this.value),
        lastTask: document.getElementById('task-input').value
    };
    saveFocusSettings(settings);
});

document.getElementById('task-input').addEventListener('change', function() {
    const settings = {
        mode: modeSelect.value,
        duration: parseInt(durationInput.value),
        breakDuration: parseInt(breakDurationInput.value),
        lastTask: this.value
    };
    saveFocusSettings(settings);
});
 
// åˆå§‹åŒ–æ˜¾ç¤º
updateDisplay();
});
</script>
</body>
</html>
