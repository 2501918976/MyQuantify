<div class="settings-page">
    <div class="sidebar glass-weak">
        <div class="sidebar-title">⚙️ 设置</div>
        <div class="nav-item active" onclick="switchSection('appearance')">🎨 外观背景</div>
        <div class="nav-item" onclick="switchSection('data')">📊 数据采集</div>
        <div class="nav-item" onclick="switchSection('system')">🔧 系统设置</div>
        <div class="nav-item" onclick="switchSection('dataManage')">📦 数据管理</div>
        <div class="nav-item" onclick="switchSection('about')">ℹ️ 关于软件</div>
    </div>

    <div class="content-area glass-normal">
        <div id="appearance" class="content-section active">
            <div class="settings-group">
                <div class="group-title">毛玻璃特效</div>

                <div class="setting-item">
                    <div class="setting-label">
                        <div class="setting-title">模糊程度</div>
                        <div class="setting-description">调整背景毛玻璃效果的模糊强度</div>
                    </div>
                    <span class="range-value" id="blurIntensityValue">8px</span>
                </div>
                <input type="range" class="range-input" id="blurIntensity" min="0" max="20" value="8" step="1" oninput="updateBlurEffect('blurIntensity', 'blurIntensityValue')">

                <div class="setting-item" style="margin-top: 20px;">
                    <div class="setting-label">
                        <div class="setting-title">不透明度</div>
                        <div class="setting-description">调整界面元素的透明度</div>
                    </div>
                    <span class="range-value" id="opacityValue">80%</span>
                </div>
                <input type="range" class="range-input" id="opacity" min="40" max="100" value="80" step="5" oninput="updateOpacity('opacity', 'opacityValue')">

                <div class="setting-item" style="margin-top: 20px;">
                    <div class="setting-label">
                        <div class="setting-title">云母效果</div>
                        <div class="setting-description">启用 Windows 11 风格的云母材质效果</div>
                    </div>
                    <label class="switch">
                        <input type="checkbox" id="micaEffect" checked onchange="toggleMicaEffect()">
                        <span class="slider"></span>
                    </label>
                </div>

                <div class="setting-item" style="margin-top: 20px;">
                    <div class="setting-label">
                        <div class="setting-title">背景亮度</div>
                        <div class="setting-description">调整背景图片的明暗程度</div>
                    </div>
                    <span class="range-value" id="brightnessValue">100%</span>
                </div>
                <input type="range" class="range-input" id="brightness" min="50" max="150" value="100" step="5" oninput="updateBrightness('brightness', 'brightnessValue')">

                <div class="info-box">
                    💡 提示：毛玻璃效果可能会影响性能，如遇卡顿可适当降低模糊程度。
                </div>
            </div>

            <div class="settings-group">
                <div class="group-title">背景壁纸</div>
                <div class="wallpaper-grid">
                    <div class="wallpaper-card" onclick="selectWallpaper('none')">
                        <div class="wallpaper-img" style="background: #f4f7fe;"></div>
                        <div class="wallpaper-label">纯色背景</div>
                    </div>
                    <div class="wallpaper-card active" onclick="selectWallpaper('bing')">
                        <div class="wallpaper-img" style="background: linear-gradient(135deg, #ffd89b 0%, #19547b 100%);"></div>
                        <div class="wallpaper-label">Bing 每日壁纸</div>
                    </div>
                </div>
                <div class="action-buttons">
                    <button class="btn btn-secondary" onclick="uploadCustomWallpaper()">📁 上传自定义壁纸</button>
                </div>
            </div>
        </div>

        <div id="data" class="content-section">
            <div class="setting-item">
                <div class="setting-label">
                    <div class="setting-title">数据写入周期</div>
                    <div class="setting-description">设置数据保存到数据库的时间间隔</div>
                </div>
                <span class="range-value" id="writeIntervalValue">5.0分钟</span>
            </div>
            <input type="range" class="range-input" id="writeInterval" min="60" max="600" value="300" step="30" oninput="updateRangeValue('writeInterval', 'writeIntervalValue', 's', 60)">

            <div class="setting-item" style="margin-top: 20px;">
                <div class="setting-label">
                    <div class="setting-title">AFK 触发时间</div>
                    <div class="setting-description">多久无操作后判定为离开状态</div>
                </div>
                <span class="range-value" id="afkTimeValue">2.0分钟</span>
            </div>
            <input type="range" class="range-input" id="afkTime" min="10" max="300" value="120" step="10" oninput="updateRangeValue('afkTime', 'afkTimeValue', 's', 60)">

            <div class="setting-item" style="margin-top: 20px;">
                <div class="setting-label">
                    <div class="setting-title">短期窗口过滤</div>
                    <div class="setting-description">忽略少于此时长的应用切换记录</div>
                </div>
                <span class="range-value" id="filterTimeValue">3s</span>
            </div>
            <input type="range" class="range-input" id="filterTime" min="0" max="10" value="3" step="1" oninput="updateRangeValue('filterTime', 'filterTimeValue', 's', 1)">

            <div class="info-box">
                💡 提示：较短的写入周期会增加磁盘 I/O 负担，较长的周期在程序异常退出时可能导致少量数据丢失。
            </div>
        </div>

        <div id="system" class="content-section">
            <div class="setting-item">
                <div class="setting-label">
                    <div class="setting-title">开机自动启动</div>
                    <div class="setting-description">Windows 启动时自动后台运行</div>
                </div>
                <label class="switch">
                    <input type="checkbox" id="autoStart" onchange="toggleAutoStart()">
                    <span class="slider"></span>
                </label>
            </div>

            <div class="setting-item">
                <div class="setting-label">
                    <div class="setting-title">最小化到系统托盘</div>
                    <div class="setting-description">点击关闭按钮时隐藏到通知区域</div>
                </div>
                <label class="switch">
                    <input type="checkbox" id="minimizeToTray" checked onchange="toggleMinimizeToTray()">
                    <span class="slider"></span>
                </label>
            </div>

            <div class="setting-item">
                <div class="setting-label">
                    <div class="setting-title">显示桌面通知</div>
                    <div class="setting-description">开启重要记录或系统状态提示</div>
                </div>
                <label class="switch">
                    <input type="checkbox" id="showNotifications" checked onchange="toggleNotifications()">
                    <span class="slider"></span>
                </label>
            </div>
        </div>

        <div id="dataManage" class="content-section">
            <div class="setting-item">
                <div class="setting-label">
                    <div class="setting-title">合并数据库</div>
                    <div class="setting-description">整理碎片并优化存储空间占用</div>
                </div>
                <button class="btn btn-primary" onclick="mergeDatabase()">开始合并</button>
            </div>

            <div class="setting-item">
                <div class="setting-label">
                    <div class="setting-title">导出备份</div>
                    <div class="setting-description">将数据导出为 CSV 或 JSON 格式</div>
                </div>
                <button class="btn btn-secondary" onclick="exportData()">导出数据</button>
            </div>

            <div class="setting-item">
                <div class="setting-label">
                    <div class="setting-title">危险区域</div>
                    <div class="setting-description">清空所有本地历史追踪记录（不可恢复）</div>
                </div>
                <button class="btn btn-secondary" onclick="clearData()" style="color: #e74a3b; border-color: #e74a3b;">清空数据</button>
            </div>

            <div class="info-box">
                📊 当前统计：数据库大小 128.5 MB | 累计记录 45,672 条
            </div>
        </div>

        <div id="about" class="content-section">
            <div class="section-header">关于软件</div>
            <div style="text-align: center; padding: 20px 0;">
                <div style="font-size: 24px; font-weight: 800; color: var(--primary-color);">SelfTracker</div>
                <div style="color: var(--text-secondary); margin-top: 8px;">版本 v1.0.0 Stable</div>
                <p style="font-size: 13px; line-height: 1.6; color: var(--text-main); max-width: 400px; margin: 20px auto;">
                    SelfTracker 是一款开源的个人时间追踪工具，旨在帮助用户了解自己的电脑使用习惯，提升数字生产力。
                </p>
            </div>
            <div class="action-buttons" style="justify-content: center;">
                <button class="btn btn-primary" onclick="checkUpdate()">检查更新</button>
                <button class="btn btn-secondary" onclick="openGithub()">GitHub 仓库</button>
            </div>
        </div>
    </div>
</div>
